# 쿠버네티스 네트워크

## 파드 내부 컨테이너간 통신
host로 `localhost`를 사용하면 된다.
<br><br>

## 클러스터 내부 파드간 통신
수동으로 클러스터 내부 IP를 찾아 Pod간 통신에서 host로 사용해도 되지만 번거롭다.
<br><br>

### 환경변수
쿠버네티스는 자동으로 `Service`의 IP를 환경변수로 할당해준다.

<br><br>

포맷은 다음과 같다.
> `서비스명` + "_SERVICE_HOST"

여기서 `서비스명`은 `metadata.name`의 값을 소문자는 대문자로, `-`는 `_`로 바꾼 값이다.
<br><br>

### CoreDNS 
최신버전의 쿠버네티스에서는 **내부적인 DNS가 존재해 도메인 네임으로 다른 서비스에 접근할 수 있다.**

자동으로 생성되는 서비스의 도메인 네임의 포맷은 다음과 같다.
> `서비스명` + "." + `네임스페이스명`

<br>

`서비스명`은 `metadata.name`값을 그대로 쓰고 `네임스페이스명`은 말그대로 서비스의 네임스페이스를 사용하면된다.  
(별도로 설정하지 않으면 기본 namespace는 `default`이다.)
 
 별도로 테스트 해보니 원리는 모르겠지만 `서비스명`만 써도 접근이 된다. 아마 `default` 네임스페이스에 속하기 때문인 것 같다.